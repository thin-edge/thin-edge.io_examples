import * as tslib_1 from "tslib";
import { Component, ContentChild, ElementRef, ContentChildren, HostBinding, Input, Output, EventEmitter, QueryList } from '@angular/core';
import { Subject } from 'rxjs';
import { takeUntil, filter, tap, delay } from 'rxjs/operators';
import { ListItemActionComponent } from './list-item-action.component';
import { ListItemCollapseComponent } from './list-item-collapse.component';
import { ListItemFooterComponent } from './list-item-footer.component';
/**
 * A list item is a representation of an item inside a list and
 * can be used to compose different styles in a list (mainly in a
 * <c8y-group-list>-component but also in others like the
 * <c8y-typeahead>-component):
 *  - a list with a footer
 *  - a list with one or multiple actions
 *  - an icon
 *  - a checkbox or radio input
 *
 * The item can be composed via content projection. The following
 * example shows a radio list with an icon, two actions
 * and a footer:
 * ```html
 * <c8y-list-group>
 *   <c8y-li
 *     *c8yFor="
 *       let device of devices;
 *       let i = index;
 *     "
 *   >
 *     <c8y-li-radio (onSelect)="updateSelected($event, device)"></c8y-li-radio>
 *     <c8y-li-icon [icon]="'rocket'"></c8y-li-icon>
 *     {{ i + 1 }}. {{ device.name || '-' }}
 *     <c8y-li-footer>
 *       Device id: <a [routerLink]="['/device', device.id]">{{ device.id }}</a>
 *     </c8y-li-footer>
 *     <c8y-li-action (click)="deleteDevice(device.id)" icon="times">
 *       Delete
 *     </c8y-li-action>
 *     <c8y-li-action (click)="(false)" icon="rocket">
 *       Launch to space
 *     </c8y-li-action>
 *   </c8y-li>
 * </c8y-list-group>
 * ```
 */
let ListItemComponent = class ListItemComponent {
    /**
     * @ignore
     */
    constructor(element) {
        this.element = element;
        /**
         * If set to true, the class "active" is added which
         * indicates that the current row is active.
         */
        this.active = false;
        /**
         * Indicates if the current list item is collapsed. You can trigger the collapsing from
         * any element event by toggling this value.
         *
         * @example
         * ```html
         * <c8y-li #li (click)="li.collapsed = !li.collapsed">
         *  Toggle
         *  <c8y-li-collapse>
         *    I can be toggled by clicking on the row.
         *  </c8y-li-collapse
         * </c8y-li>
         * ``
         */
        this.collapsed = true;
        /**
         * Indicates if the current list item is selectable.
         */
        this.selectable = true;
        /**
         * An event emitter which is triggered when the user collapses the content
         * via the chevron on the right.
         */
        this.collapsedChange = new EventEmitter();
        /**
         * @ignore
         */
        this.showFooter = false;
        /**
         * @ignore
         */
        this.showActions = false;
        /**
         * @ignore
         */
        this.showCollapse = false;
        /**
         * @ignore
         */
        this.dropdownUp = false;
        this.pulse$ = new Subject();
        this.destroy$ = new Subject();
        this.ACTION_ITEM_HEIGHT = 40;
    }
    /**
     * @ignore
     */
    ngOnInit() {
        this.pulse$
            .pipe(filter(apply => !!apply), tap(() => this.element.nativeElement.classList.remove('c8y-list--pulse')), delay(100), tap(() => this.element.nativeElement.classList.add('c8y-list--pulse')), takeUntil(this.destroy$))
            .subscribe();
    }
    /**
     * @ignore
     */
    ngAfterContentChecked() {
        this.actions = this.itemActions.toArray();
        this.showFooter = this.itemFooter != null;
        this.showActions = this.itemActions.length > 0;
        this.showCollapse = this.itemCollapse != null;
    }
    /**
     * @ignore
     */
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    /**
     * A helper function which helps to determine if the dropdown
     * should toggle up.
     */
    showDropdownUp() {
        const listItemRect = this.element.nativeElement.getBoundingClientRect();
        const dropdownTop = listItemRect.top;
        const dropdownHeightWithToggle = (1 + this.itemActions.length) * this.ACTION_ITEM_HEIGHT;
        const availableHeight = window.innerHeight;
        const dropdownDownFits = dropdownTop + dropdownHeightWithToggle <= availableHeight;
        this.dropdownUp = !dropdownDownFits;
    }
    /**
     * Toggles the collapse state and emits this state as
     * collapsedChange output as boolean.
     * @param $event Pass optional an event to stop propagation.
     */
    toggleCollapsed($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.collapsed = !this.collapsed;
        this.collapsedChange.emit(this.collapsed);
    }
    /**
     * Highlights the list-item. This method should be used to show the
     * user that something within this item was changed.
     */
    pulse() {
        this.pulse$.next(true);
    }
};
ListItemComponent.ctorParameters = () => [
    { type: ElementRef }
];
tslib_1.__decorate([
    Input(),
    HostBinding('class.active')
], ListItemComponent.prototype, "active", void 0);
tslib_1.__decorate([
    Input()
], ListItemComponent.prototype, "collapsed", void 0);
tslib_1.__decorate([
    Input()
], ListItemComponent.prototype, "selectable", void 0);
tslib_1.__decorate([
    Output()
], ListItemComponent.prototype, "collapsedChange", void 0);
tslib_1.__decorate([
    ContentChild(ListItemFooterComponent, { static: false })
], ListItemComponent.prototype, "itemFooter", void 0);
tslib_1.__decorate([
    ContentChildren(ListItemActionComponent)
], ListItemComponent.prototype, "itemActions", void 0);
tslib_1.__decorate([
    ContentChild(ListItemCollapseComponent, { static: false })
], ListItemComponent.prototype, "itemCollapse", void 0);
ListItemComponent = tslib_1.__decorate([
    Component({
        selector: 'c8y-list-item, c8y-li',
        template: "<div [ngClass]=\"{ 'expanded': !collapsed, interact: (itemCollapse && itemCollapse.collapseWay === 'row')}\">\n  <div class=\"c8y-list__item__block\">\n    <ng-content select=\"c8y-list-item-radio, c8y-li-radio\"></ng-content>\n    <ng-content select=\"c8y-list-item-checkbox, c8y-li-checkbox\"></ng-content>\n\n    <ng-content select=\"c8y-list-item-icon, c8y-li-icon\"></ng-content>\n\n    <div class=\"c8y-list__item__body text-truncate-wrap\" (click)=\"(itemCollapse && itemCollapse.collapseWay === 'row') && toggleCollapsed()\">\n      <ng-content select=\"c8y-list-item-body, c8y-li-body\"></ng-content>\n      <ng-content></ng-content>\n      <div class=\"c8y-list__item__footer\" *ngIf=\"showFooter\">\n        <ng-content select=\"c8y-list-item-footer, c8y-li-footer\"></ng-content>\n      </div>\n    </div>\n\n    <div class=\"c8y-list__item__actions\" *ngIf=\"(showCollapse && (itemCollapse && itemCollapse.collapseWay === 'button')) || showActions\">\n      <button\n        class=\"collapse-btn\"\n        title=\"{{ 'Expand' | translate }}\"\n        type=\"button\"\n        (click)=\"toggleCollapsed($event)\"\n        [attr.aria-expanded]=\"!collapsed\"\n        *ngIf=\"showCollapse && itemCollapse.collapseWay === 'button'\"\n      >\n        <i [c8yIcon]=\"'chevron-down'\"></i>\n      </button>\n      <div\n        class=\"dropdown\"\n        dropdown\n        [dropup]=\"dropdownUp\"\n        *ngIf=\"showActions\"\n        (onShown)=\"showDropdownUp()\"\n      >\n        <button\n          class=\"dropdown-toggle c8y-dropdown\"\n          dropdownToggle\n          title=\"{{ 'Actions' | translate }}\"\n          type=\"button\"\n          aria-haspopup=\"true\"\n        >\n          <i [c8yIcon]=\"'ellipsis-v'\"></i>\n        </button>\n        <ul class=\"dropdown-menu dropdown-menu-right\" *dropdownMenu>\n          <ng-content select=\"c8y-list-item-action, c8y-li-action\"></ng-content>\n          <ng-container *ngFor=\"let action of actions\">\n            <ng-container *ngTemplateOutlet=\"action.template\"></ng-container>\n          </ng-container>\n        </ul>\n      </div>\n\n      <ng-content select=\"c8y-list-item-action, c8y-li-action\" *ngIf=\"showActions\"></ng-content>\n    </div>\n  </div>\n\n  <div *ngIf=\"showCollapse\" [collapse]=\"collapsed\" [isAnimated]=\"true\">\n    <div class=\"c8y-list__item__collapse--container\">\n      <ng-content select=\"c8y-list-item-collapse, c8y-li-collapse\"></ng-content>\n    </div>\n  </div>\n</div>\n",
        host: {
            class: 'c8y-list__item'
        }
    })
], ListItemComponent);
export { ListItemComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC1pdGVtLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjOHkvbmd4LWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJjb3JlL2xpc3QtZ3JvdXAvbGlzdC1pdGVtLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxZQUFZLEVBQ1osVUFBVSxFQUNWLGVBQWUsRUFDZixXQUFXLEVBQ1gsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBQ1osU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9ELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ3ZFLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQzNFLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBRXZFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQ0c7QUFRSCxJQUFhLGlCQUFpQixHQUE5QixNQUFhLGlCQUFpQjtJQWtINUI7O09BRUc7SUFDSCxZQUFtQixPQUFtQjtRQUFuQixZQUFPLEdBQVAsT0FBTyxDQUFZO1FBcEh0Qzs7O1dBR0c7UUFHSCxXQUFNLEdBQVksS0FBSyxDQUFDO1FBRXhCOzs7Ozs7Ozs7Ozs7O1dBYUc7UUFFSCxjQUFTLEdBQVksSUFBSSxDQUFDO1FBRTFCOztXQUVHO1FBRUgsZUFBVSxHQUFZLElBQUksQ0FBQztRQUUzQjs7O1dBR0c7UUFFSCxvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFXLENBQUM7UUFvRDlDOztXQUVHO1FBQ0gsZUFBVSxHQUFZLEtBQUssQ0FBQztRQUM1Qjs7V0FFRztRQUNILGdC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M0I7SUFEQyxNQUFNLEVBQUU7MERBQ3FDO0FBZTlDO0lBREMsWUFBWSxDQUFDLHVCQUF1QixFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDO3FEQUNyQjtBQW9CcEM7SUFEQyxlQUFlLENBQUMsdUJBQXVCLENBQUM7c0RBQ087QUFlaEQ7SUFEQyxZQUFZLENBQUMseUJBQXlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLENBQUM7dURBQ25CO0FBdkY3QixpQkFBaUI7SUFQN0IsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLHVCQUF1QjtRQUNqQyw4OEVBQXlDO1FBQ3pDLElBQUksRUFBRTtZQUNKLEtBQUssRUFBRSxnQkFBZ0I7U0FDeEI7S0FDRixDQUFDO0dBQ1csaUJBQWlCLENBeUw3QjtTQXpMWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZCxcbiAgRWxlbWVudFJlZixcbiAgQ29udGVudENoaWxkcmVuLFxuICBIb3N0QmluZGluZyxcbiAgSW5wdXQsXG4gIE91dHB1dCxcbiAgRXZlbnRFbWl0dGVyLFxuICBRdWVyeUxpc3Rcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlVW50aWwsIGZpbHRlciwgdGFwLCBkZWxheSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IExpc3RJdGVtQWN0aW9uQ29tcG9uZW50IH0gZnJvbSAnLi9saXN0LWl0ZW0tYWN0aW9uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBMaXN0SXRlbUNvbGxhcHNlQ29tcG9uZW50IH0gZnJvbSAnLi9saXN0LWl0ZW0tY29sbGFwc2UuY29tcG9uZW50JztcbmltcG9ydCB7IExpc3RJdGVtRm9vdGVyQ29tcG9uZW50IH0gZnJvbSAnLi9saXN0LWl0ZW0tZm9vdGVyLmNvbXBvbmVudCc7XG5cbi8qKlxuICogQSBsaXN0IGl0ZW0gaXMgYSByZXByZXNlbnRhdGlvbiBvZiBhbiBpdGVtIGluc2lkZSBhIGxpc3QgYW5kXG4gKiBjYW4gYmUgdXNlZCB0byBjb21wb3NlIGRpZmZlcmVudCBzdHlsZXMgaW4gYSBsaXN0IChtYWlubHkgaW4gYVxuICogPGM4eS1ncm91cC1saXN0Pi1jb21wb25lbnQgYnV0IGFsc28gaW4gb3RoZXJzIGxpa2UgdGhlXG4gKiA8Yzh5LXR5cGVhaGVhZD4tY29tcG9uZW50KTpcbiAqICAtIGEgbGlzdCB3aXRoIGEgZm9vdGVyXG4gKiAgLSBhIGxpc3Qgd2l0aCBvbmUgb3IgbXVsdGlwbGUgYWN0aW9uc1xuICogIC0gYW4gaWNvblxuICogIC0gYSBjaGVja2JveCBvciByYWRpbyBpbnB1dFxuICpcbiAqIFRoZSBpdGVtIGNhbiBiZSBjb21wb3NlZCB2aWEgY29udGVudCBwcm9qZWN0aW9uLiBUaGUgZm9sbG93aW5nXG4gKiBleGFtcGxlIHNob3dzIGEgcmFkaW8gbGlzdCB3aXRoIGFuIGljb24sIHR3byBhY3Rpb25zXG4gKiBhbmQgYSBmb290ZXI6XG4gKiBgYGBodG1sXG4gKiA8Yzh5LWxpc3QtZ3JvdXA+XG4gKiAgIDxjOHktbGlcbiAqICAgICAqYzh5Rm9yPVwiXG4gKiAgICAgICBsZXQgZGV2aWNlIG9mIGRldmljZXM7XG4gKiAgICAgICBsZXQgaSA9IGluZGV4O1xuICogICAgIFwiXG4gKiAgID5cbiAqICAgICA8Yzh5LWxpLXJhZGlvIChvblNlbGVjdCk9XCJ1cGRhdGVTZWxlY3RlZCgkZXZlbnQsIGRldmljZSlcIj48L2M4eS1saS1yYWRpbz5cbiAqICAgICA8Yzh5LWxpLWljb24gW2ljb25dPVwiJ3JvY2tldCdcIj48L2M4eS1saS1pY29uPlxuICogICAgIHt7IGkgKyAxIH19LiB7eyBkZXZpY2UubmFtZSB8fCAnLScgfX1cbiAqICAgICA8Yzh5LWxpLWZvb3Rlcj5cbiAqICAgICAgIERldmljZSBpZDogPGEgW3JvdXRlckxpbmtdPVwiWycvZGV2aWNlJywgZGV2aWNlLmlkXVwiPnt7IGRldmljZS5pZCB9fTwvYT5cbiAqICAgICA8L2M4eS1saS1mb290ZXI+XG4gKiAgICAgPGM4eS1saS1hY3Rpb24gKGNsaWNrKT1cImRlbGV0ZURldmljZShkZXZpY2UuaWQpXCIgaWNvbj1cInRpbWVzXCI+XG4gKiAgICAgICBEZWxldGVcbiAqICAgICA8L2M4eS1saS1hY3Rpb24+XG4gKiAgICAgPGM4eS1saS1hY3Rpb24gKGNsaWNrKT1cIihmYWxzZSlcIiBpY29uPVwicm9ja2V0XCI+XG4gKiAgICAgICBMYXVuY2ggdG8gc3BhY2VcbiAqICAgICA8L2M4eS1saS1hY3Rpb24+XG4gKiAgIDwvYzh5LWxpPlxuICogPC9jOHktbGlzdC1ncm91cD5cbiAqIGBgYFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktbGlzdC1pdGVtLCBjOHktbGknLFxuICB0ZW1wbGF0ZVVybDogJy4vbGlzdC1pdGVtLmNvbXBvbmVudC5odG1sJyxcbiAgaG9zdDoge1xuICAgIGNsYXNzOiAnYzh5LWxpc3RfX2l0ZW0nXG4gIH1cbn0pXG5leHBvcnQgY2xhc3MgTGlzdEl0ZW1Db21wb25lbnQge1xuICAvKipcbiAgICogSWYgc2V0IHRvIHRydWUsIHRoZSBjbGFzcyBcImFjdGl2ZVwiIGlzIGFkZGVkIHdoaWNoXG4gICAqIGluZGljYXRlcyB0aGF0IHRoZSBjdXJyZW50IHJvdyBpcyBhY3RpdmUuXG4gICAqL1xuICBASW5wdXQoKVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmFjdGl2ZScpXG4gIGFjdGl2ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBJbmRpY2F0ZXMgaWYgdGhlIGN1cnJlbnQgbGlzdCBpdGVtIGlzIGNvbGxhcHNlZC4gWW91IGNhbiB0cmlnZ2VyIHRoZSBjb2xsYXBzaW5nIGZyb21cbiAgICogYW55IGVsZW1lbnQgZXZlbnQgYnkgdG9nZ2xpbmcgdGhpcyB2YWx1ZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgaHRtbFxuICAgKiA8Yzh5LWxpICNsaSAoY2xpY2spPVwibGkuY29sbGFwc2VkID0gIWxpLmNvbGxhcHNlZFwiPlxuICAgKiAgVG9nZ2xlXG4gICAqICA8Yzh5LWxpLWNvbGxhcHNlPlxuICAgKiAgICBJIGNhbiBiZSB0b2dnbGVkIGJ5IGNsaWNraW5nIG9uIHRoZSByb3cuXG4gICAqICA8L2M4eS1saS1jb2xsYXBzZVxuICAgKiA8L2M4eS1saT5cbiAgICogYGBcbiAgICovXG4gIEBJbnB1dCgpXG4gIGNvbGxhcHNlZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyBpZiB0aGUgY3VycmVudCBsaXN0IGl0ZW0gaXMgc2VsZWN0YWJsZS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHNlbGVjdGFibGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBBbiBldmVudCBlbWl0dGVyIHdoaWNoIGlzIHRyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIGNvbGxhcHNlcyB0aGUgY29udGVudFxuICAgKiB2aWEgdGhlIGNoZXZyb24gb24gdGhlIHJpZ2h0LlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGNvbGxhcHNlZENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcblxuICAvKipcbiAgICogQSBbW0xpc3RJdGVtRm9vdGVyQ29tcG9uZW50XV0gZWxlbWVudCB3aGljaCBjYW4gYmUgdXNlZCB0byBzaG93IGEgZm9vdGVyLlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBodG1sXG4gICAqIDxjOHktbGk+XG4gICAqICBJIGFtIHRoZSBtYWluIGNvbnRlbnRcbiAgICogIDxjOHktbGktZm9vdGVyPlxuICAgKiAgICBJIGFtIHRoZSBmb290ZXIgY29udGVudFxuICAgKiAgPC9jOHktbGktZm9vdGVyPlxuICAgKiA8L2M4eS1saT5cbiAgICogYGBgXG4gICAqL1xuICBAQ29udGVudENoaWxkKExpc3RJdGVtRm9vdGVyQ29tcG9uZW50LCB7IHN0YXRpYzogZmFsc2UgfSlcbiAgaXRlbUZvb3RlcjogTGlzdEl0ZW1Gb290ZXJDb21wb25lbnQ7XG5cbiAgLyoqXG4gICAqIFtbTGlzdEl0ZW1BY3Rpb25Db21wb25lbnRdXSBlbGVtZW50cyB3aGljaCBjYW4gYmUgdXNlZCB0byBzaG93IGFuIGFjdGlvbi5cbiAgICogQW4gYWN0aW9uIGlzIGRpc3BsYXllZCBvbiB0aGUgcmlnaHQgaW4gdGhlIGRyb3Bkb3duIGFuZCB1c3VhbGx5IGNvbnNpc3RzIG9mIGFuXG4gICAqIGljb24gYW5kIGEgbGFiZWwuXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGh0bWxcbiAgICogPGM4eS1saT5cbiAgICogIEkgYW0gdGhlIG1haW4gY29udGVudFxuICAgKiAgPGM4eS1saS1hY3Rpb24gKGNsaWNrKT1cImxhdW5jaFRvU3BhY2UoZGV2aWNlLmlkKVwiIGljb249XCJyb2NrZXRcIj5cbiAgICogICAgTGF1bmNoXG4gICAqICA8L2M4eS1saS1hY3Rpb24+XG4gICAqICA8Yzh5LWxpLWFjdGlvbiAoY2xpY2spPVwiZGVsZXRlRGV2aWNlKGRldmljZS5pZClcIiBpY29uPVwidGltZXNcIj5cbiAgICogICAgRGVsZXRlXG4gICAqICA8L2M4eS1saS1hY3Rpb24+XG4gICAqIDwvYzh5LWxpPlxuICAgKiBgYGBcbiAgICovXG4gIEBDb250ZW50Q2hpbGRyZW4oTGlzdEl0ZW1BY3Rpb25Db21wb25lbnQpXG4gIGl0ZW1BY3Rpb25zOiBRdWVyeUxpc3Q8TGlzdEl0ZW1BY3Rpb25Db21wb25lbnQ+O1xuXG4gIC8qKlxuICAgKiBbW0xpc3RJdGVtQ29sbGFwc2VDb21wb25lbnRdXSBlbGVtZW50cyB3aGljaCBjYW4gYmUgdXNlZCB0byBzaG93IGRldGFpbCB2aWV3cy5cbiAgICogQGV4YW1wbGVcbiAgICogYGBgaHRtbFxuICAgKiA8Yzh5LWxpPlxuICAgKiAgSSBhbSB0aGUgbWFpbiBjb250ZW50XG4gICAqICA8Yzh5LWxpLWNvbGxhcHNlPlxuICAgKiAgICBJIGFtIGRldGFpbGVkIGNvbnRlbnRcbiAgICogIDwvYzh5LWxpLWNvbGxhcHNlPlxuICAgKiA8L2M4eS1saT5cbiAgICogYGBgXG4gICAqL1xuICBAQ29udGVudENoaWxkKExpc3RJdGVtQ29sbGFwc2VDb21wb25lbnQsIHsgc3RhdGljOiBmYWxzZSB9KVxuICBpdGVtQ29sbGFwc2U6IExpc3RJdGVtQ29sbGFwc2VDb21wb25lbnQ7XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHNob3dGb290ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHNob3dBY3Rpb25zOiBib29sZWFuID0gZmFsc2U7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBzaG93Q29sbGFwc2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGFjdGlvbnM6IExpc3RJdGVtQWN0aW9uQ29tcG9uZW50W107XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBkcm9wZG93blVwOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBwdWxzZSQ6IFN1YmplY3Q8Ym9vbGVhbj4gPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuICBwcml2YXRlIGRlc3Ryb3kkOiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdCgpO1xuICBwcml2YXRlIHJlYWRvbmx5IEFDVElPTl9JVEVNX0hFSUdIVCA9IDQwO1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgZWxlbWVudDogRWxlbWVudFJlZikge31cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5wdWxzZSRcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoYXBwbHkgPT4gISFhcHBseSksXG4gICAgICAgIHRhcCgoKSA9PiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjOHktbGlzdC0tcHVsc2UnKSksXG4gICAgICAgIGRlbGF5KDEwMCksXG4gICAgICAgIHRhcCgoKSA9PiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjOHktbGlzdC0tcHVsc2UnKSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpOiB2b2lkIHtcbiAgICB0aGlzLmFjdGlvbnMgPSB0aGlzLml0ZW1BY3Rpb25zLnRvQXJyYXkoKTtcbiAgICB0aGlzLnNob3dGb290ZXIgPSB0aGlzLml0ZW1Gb290ZXIgIT0gbnVsbDtcbiAgICB0aGlzLnNob3dBY3Rpb25zID0gdGhpcy5pdGVtQWN0aW9ucy5sZW5ndGggPiAwO1xuICAgIHRoaXMuc2hvd0NvbGxhcHNlID0gdGhpcy5pdGVtQ29sbGFwc2UgIT0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQSBoZWxwZXIgZnVuY3Rpb24gd2hpY2ggaGVscHMgdG8gZGV0ZXJtaW5lIGlmIHRoZSBkcm9wZG93blxuICAgKiBzaG91bGQgdG9nZ2xlIHVwLlxuICAgKi9cbiAgc2hvd0Ryb3Bkb3duVXAoKSB7XG4gICAgY29uc3QgbGlzdEl0ZW1SZWN0OiBET01SZWN0ID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgZHJvcGRvd25Ub3AgPSBsaXN0SXRlbVJlY3QudG9wO1xuICAgIGNvbnN0IGRyb3Bkb3duSGVpZ2h0V2l0aFRvZ2dsZSA9ICgxICsgdGhpcy5pdGVtQWN0aW9ucy5sZW5ndGgpICogdGhpcy5BQ1RJT05fSVRFTV9IRUlHSFQ7XG4gICAgY29uc3QgYXZhaWxhYmxlSGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIGNvbnN0IGRyb3Bkb3duRG93bkZpdHMgPSBkcm9wZG93blRvcCArIGRyb3Bkb3duSGVpZ2h0V2l0aFRvZ2dsZSA8PSBhdmFpbGFibGVIZWlnaHQ7XG4gICAgdGhpcy5kcm9wZG93blVwID0gIWRyb3Bkb3duRG93bkZpdHM7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlcyB0aGUgY29sbGFwc2Ugc3RhdGUgYW5kIGVtaXRzIHRoaXMgc3RhdGUgYXNcbiAgICogY29sbGFwc2VkQ2hhbmdlIG91dHB1dCBhcyBib29sZWFuLlxuICAgKiBAcGFyYW0gJGV2ZW50IFBhc3Mgb3B0aW9uYWwgYW4gZXZlbnQgdG8gc3RvcCBwcm9wYWdhdGlvbi5cbiAgICovXG4gIHRvZ2dsZUNvbGxhcHNlZCgkZXZlbnQ/OiBFdmVudCkge1xuICAgIGlmICgkZXZlbnQpIHtcbiAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gICAgdGhpcy5jb2xsYXBzZWQgPSAhdGhpcy5jb2xsYXBzZWQ7XG4gICAgdGhpcy5jb2xsYXBzZWRDaGFuZ2UuZW1pdCh0aGlzLmNvbGxhcHNlZCk7XG4gIH1cblxuICAvKipcbiAgICogSGlnaGxpZ2h0cyB0aGUgbGlzdC1pdGVtLiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCB0byBzaG93IHRoZVxuICAgKiB1c2VyIHRoYXQgc29tZXRoaW5nIHdpdGhpbiB0aGlzIGl0ZW0gd2FzIGNoYW5nZWQuXG4gICAqL1xuICBwdWxzZSgpIHtcbiAgICB0aGlzLnB1bHNlJC5uZXh0KHRydWUpO1xuICB9XG59XG4iXX0=